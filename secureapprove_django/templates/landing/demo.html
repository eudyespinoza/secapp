{% extends 'base.html' %}
{% load i18n %}

{% block title %}{% trans "Demo - SecureApprove" %}{% endblock %}

{% block extra_css %}
<style>
        /* Demo-specific styles */
        .demo-container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .approval-card {
            box-shadow: 0 4px 15px var(--card-shadow);
            border: none;
            border-radius: 12px;
            background-color: var(--card-bg);
        }
        
        [data-theme="dark"] .approval-card {
            background-color: var(--card-bg) !important;
            border: 1px solid var(--border-color) !important;
        }
        
        [data-theme="dark"] .approval-card .card-header {
            background-color: var(--bg-secondary) !important;
            border-color: var(--border-color) !important;
        }
        
        [data-theme="dark"] .approval-card .card-body {
            color: var(--text-color) !important;
        }
        
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }
        
        [data-theme="dark"] .status-pending {
            background: #451a03;
            color: #fbbf24;
        }
        
        .priority-badge {
            font-size: 0.875rem;
            font-weight: 600;
            padding: 0.5rem 1rem;
            border-radius: 20px;
        }
        
        .priority-high { background: #dc3545; color: white; }
        .priority-medium { background: #ffc107; color: #212529; }
        .priority-low { background: #28a745; color: white; }
        
        [data-theme="dark"] .priority-medium {
            background: #b45309;
            color: #fef3c7;
        }
        
        .category-badge {
            background: var(--primary-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .status-card {
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            color: #212529;
        }
        
        .status-card-pending { 
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%); 
        }
        
        [data-theme="dark"] .status-card-pending {
            background: linear-gradient(135deg, #78350f 0%, #92400e 100%);
            color: #fef3c7 !important;
        }
        
        [data-theme="dark"] .status-card-pending h5,
        [data-theme="dark"] .status-card-pending p {
            color: #fef3c7 !important;
        }
        
        .amount-display {
            font-size: 1.75rem;
            font-weight: 700;
            color: #2c3e50;
            background: var(--bg-secondary, #f8f9fa);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }
        
        [data-theme="dark"] .amount-display {
            color: #10b981 !important;
            background: rgba(16, 185, 129, 0.15) !important;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        
        .btn-approve {
            background: var(--secondary-color);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-approve:hover {
            background: #059669;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }
        
        .btn-reject {
            background: #dc2626;
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-reject:hover {
            background: #b91c1c;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
        }
        
        .demo-note {
            background: linear-gradient(135deg, #eff6ff, #dbeafe);
            border-left: 4px solid var(--primary-color);
        }
        
        [data-theme="dark"] .demo-note {
            background: linear-gradient(135deg, #1e3a8a, #1e40af);
            color: #dbeafe;
        }
        
        [data-theme="dark"] .demo-note p {
            color: #93c5fd !important;
        }
        
        .metadata-table th {
            background-color: var(--bg-secondary, #f8f9fa);
            font-weight: 600;
            width: 35%;
            color: var(--text-primary, #212529);
        }
        
        .metadata-table td {
            color: var(--text-primary, #212529);
        }
        
        [data-theme="dark"] .metadata-table {
            --bs-table-bg: var(--card-bg);
        }
        
        [data-theme="dark"] .metadata-table th {
            background-color: var(--bg-secondary) !important;
            color: var(--text-color) !important;
        }
        
        [data-theme="dark"] .metadata-table td {
            color: var(--text-color) !important;
        }
        
        .timeline-item {
            position: relative;
            padding-left: 2rem;
            border-left: 2px solid var(--border-color, #dee2e6);
            margin-bottom: 1rem;
            padding-bottom: 1rem;
        }
        
        .timeline-item:last-child {
            border-left: 2px solid transparent;
        }
        
        .timeline-icon {
            position: absolute;
            left: -0.625rem;
            top: 0;
            width: 1.25rem;
            height: 1.25rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
        }
        
        [data-theme="dark"] .timeline-item {
            color: var(--text-color) !important;
        }
        
        [data-theme="dark"] .bg-secondary-custom,
        [data-theme="dark"] .bg-light {
            background-color: var(--bg-secondary) !important;
        }
        
        [data-theme="dark"] .text-muted-custom,
        [data-theme="dark"] .form-label {
            color: var(--text-muted) !important;
        }
        
        [data-theme="dark"] .fw-semibold,
        [data-theme="dark"] .fw-bold {
            color: var(--text-color) !important;
        }
        
        .detail-section {
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            overflow: hidden;
        }
        
        .detail-section-header {
            background: var(--bg-secondary);
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        [data-theme="dark"] .detail-section {
            background: var(--card-bg) !important;
            border-color: var(--border-color) !important;
        }
        
        [data-theme="dark"] .detail-section-header {
            background: var(--bg-secondary) !important;
        }
        
        [data-theme="dark"] .detail-section-header h5 {
            color: var(--text-color) !important;
        }
        
        .attachment-item {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: 0.75rem 1rem;
            transition: all 0.2s ease;
        }
        
        .attachment-item:hover {
            background: var(--card-hover-bg, #e9ecef);
        }
        
        [data-theme="dark"] .attachment-item:hover {
            background: var(--bg-tertiary, #3b4a5a) !important;
        }
</style>
{% endblock %}

{% block header %}
<!-- Demo page header -->
<nav class="navbar navbar-expand-lg fixed-top">
    <div class="container">
        <a class="navbar-brand d-flex align-items-center" href="{% url 'landing:index' %}">
            <i class="bi bi-shield-check me-2 fs-4"></i>
            <span class="fw-bold">SecureApprove</span>
            <span class="badge bg-info ms-2">DEMO</span>
        </a>
        
        <div class="d-flex align-items-center gap-3">
            <!-- Theme Switcher -->
            <div class="dropdown">
                <button class="control-button" type="button" id="themeDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="bi bi-sun" id="themeIcon"></i>
                    <span id="themeText">{% trans "Claro" %}</span>
                    <i class="bi bi-chevron-down"></i>
                </button>
                <ul class="dropdown-menu" aria-labelledby="themeDropdown">
                    <li><button class="dropdown-item" onclick="setTheme('light')" data-theme-option="light">
                        <i class="bi bi-sun me-2"></i> {% trans "Claro" %}
                    </button></li>
                    <li><button class="dropdown-item" onclick="setTheme('dark')" data-theme-option="dark">
                        <i class="bi bi-moon me-2"></i> {% trans "Oscuro" %}
                    </button></li>
                    <li><button class="dropdown-item" onclick="setTheme('system')" data-theme-option="system">
                        <i class="bi bi-display me-2"></i> {% trans "Sistema" %}
                    </button></li>
                </ul>
            </div>
            
            <!-- Language Switcher -->
            <div class="dropdown">
                <button class="control-button" type="button" id="languageDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                    <span id="currentFlag"></span>
                    <span id="currentLang">ES</span>
                    <i class="bi bi-chevron-down"></i>
                </button>
                <ul class="dropdown-menu" aria-labelledby="languageDropdown">
                    {% get_available_languages as LANGUAGES %}
                    {% get_current_language as LANGUAGE_CODE %}
                    {% for lang_code, lang_name in LANGUAGES %}
                    <li>
                        <form action="{% url 'set_language' %}" method="post" class="d-inline">
                            {% csrf_token %}
                            <input name="next" type="hidden" value="{{ request.get_full_path }}" />
                            <input name="language" type="hidden" value="{{ lang_code }}" />
                            <button type="submit" class="dropdown-item {% if LANGUAGE_CODE == lang_code %}active{% endif %}" data-lang="{{ lang_code }}">
                                {% if lang_code == 'es' %}<span class="me-2"></span> Espa帽ol
                                {% elif lang_code == 'en' %}<span class="me-2">吼</span> English
                                {% elif lang_code == 'pt-br' %}<span class="me-2">ю</span> Portugu锚s
                                {% endif %}
                            </button>
                        </form>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            
            <a href="{% url 'landing:index' %}" class="btn btn-outline-primary">
                <i class="bi bi-arrow-left me-1"></i>
                {% trans "Volver" %}
            </a>
            <a href="{% url 'billing:select_plan' %}" class="btn btn-primary-custom">
                {% trans "Comenzar Ahora" %}
            </a>
        </div>
    </div>
</nav>

<div style="padding-top: 80px;">
{% endblock %}

{% block content %}
<!-- Demo Content -->
<section class="py-5">
    <div class="container">
        <div class="demo-container">
            <!-- Demo Info -->
            <div class="demo-note p-4 rounded-3 mb-4">
                <div class="d-flex align-items-center mb-2">
                    <i class="bi bi-info-circle-fill text-primary-custom me-2"></i>
                    <h5 class="mb-0 fw-bold">{% trans "Demostraci贸n Interactiva" %}</h5>
                </div>
                <p class="mb-0 text-muted-custom">
                    {% trans "Esta es una demo de c贸mo funciona el proceso de aprobaci贸n en SecureApprove. Los botones son interactivos para simular la experiencia real." %}
                </p>
            </div>

            <!-- Approval Request Card -->
            <div class="card approval-card">
                <!-- Header with title and badges -->
                <div class="card-header py-3">
                    <div class="d-flex justify-content-between align-items-start flex-wrap gap-2">
                        <div>
                            <h4 class="mb-2 fw-bold">{% trans "Compra de Equipos de Oficina" %}</h4>
                            <div class="d-flex gap-2 flex-wrap">
                                <span class="category-badge">
                                    <i class="bi bi-cart me-1"></i>
                                    {% trans "Compra" %}
                                </span>
                                <span class="priority-badge priority-medium">
                                    {% trans "Prioridad Media" %}
                                </span>
                                <small class="text-muted-custom d-flex align-items-center">
                                    <i class="bi bi-calendar me-1"></i>
                                    {% now "d/m/Y H:i" %}
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card-body">
                    <!-- Status Card -->
                    <div class="status-card status-card-pending mb-4">
                        <div class="d-flex align-items-center justify-content-between flex-wrap gap-3">
                            <div>
                                <h5 class="mb-1">
                                    <i class="bi bi-clock text-warning me-2"></i>
                                    {% trans "Pendiente de Aprobaci贸n" %}
                                </h5>
                                <p class="mb-0">
                                    {% trans "Esta solicitud est谩 esperando aprobaci贸n de un administrador." %}
                                </p>
                            </div>
                            <div class="amount-display">
                                $2,500.00
                            </div>
                        </div>
                    </div>
                    
                    <!-- Request Details Section -->
                    <div class="detail-section mb-4">
                        <div class="detail-section-header">
                            <h5 class="mb-0">
                                <i class="bi bi-file-text me-2"></i>
                                {% trans "Detalles de la Solicitud" %}
                            </h5>
                        </div>
                        <div class="p-4">
                            <div class="row mb-4">
                                <div class="col-md-6 mb-3 mb-md-0">
                                    <h6 class="text-muted-custom small fw-bold mb-2">{% trans "DESCRIPCIN" %}</h6>
                                    <p class="mb-0">{% trans "Solicitud para la compra de 3 sillas ergon贸micas y 2 escritorios ajustables para el nuevo equipo de trabajo remoto." %}</p>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="text-muted-custom small fw-bold mb-2">{% trans "SOLICITANTE" %}</h6>
                                    <div class="d-flex align-items-center">
                                        <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center me-2" style="width: 40px; height: 40px;">
                                            <span class="text-white fw-bold">A</span>
                                        </div>
                                        <div>
                                            <div class="fw-bold">{% trans "Ana Garc铆a" %}</div>
                                            <small class="text-muted-custom">ana.garcia@empresa.com</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Metadata Table -->
                            <h6 class="text-muted-custom small fw-bold mb-2">{% trans "INFORMACIN ADICIONAL" %}</h6>
                            <table class="table table-sm metadata-table mb-0">
                                <tr>
                                    <th>{% trans "Proveedor" %}</th>
                                    <td>Ergonomic Solutions S.A.</td>
                                </tr>
                                <tr>
                                    <th>{% trans "Centro de Costo" %}</th>
                                    <td>CC-2024-045</td>
                                </tr>
                            </table>
                        </div>
                    </div>

                    <!-- Attachments Section -->
                    <div class="detail-section mb-4">
                        <div class="detail-section-header">
                            <h5 class="mb-0">
                                <i class="bi bi-paperclip me-2"></i>
                                {% trans "Documentos Adjuntos" %}
                            </h5>
                        </div>
                        <div class="p-4">
                            <div class="d-flex gap-2 flex-wrap">
                                <div class="attachment-item d-flex align-items-center">
                                    <i class="bi bi-file-pdf text-danger me-2 fs-5"></i>
                                    <div>
                                        <div class="small fw-semibold">cotizacion_equipos.pdf</div>
                                        <small class="text-muted-custom">245 KB</small>
                                    </div>
                                </div>
                                <div class="attachment-item d-flex align-items-center">
                                    <i class="bi bi-file-earmark-spreadsheet text-success me-2 fs-5"></i>
                                    <div>
                                        <div class="small fw-semibold">presupuesto_detalle.xlsx</div>
                                        <small class="text-muted-custom">128 KB</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Timeline Section -->
                    <div class="detail-section mb-4">
                        <div class="detail-section-header">
                            <h5 class="mb-0">
                                <i class="bi bi-clock-history me-2"></i>
                                {% trans "Historial" %}
                            </h5>
                        </div>
                        <div class="p-4">
                            <div class="timeline">
                                <div class="timeline-item">
                                    <div class="timeline-icon bg-primary text-white">
                                        <i class="bi bi-plus"></i>
                                    </div>
                                    <div>
                                        <strong>{% trans "Solicitud creada" %}</strong>
                                        <p class="mb-0 text-muted-custom small">{% trans "Ana Garc铆a cre贸 esta solicitud" %}</p>
                                        <small class="text-muted-custom">{% now "d/m/Y H:i" %}</small>
                                    </div>
                                </div>
                                <div class="timeline-item">
                                    <div class="timeline-icon bg-warning text-dark">
                                        <i class="bi bi-clock"></i>
                                    </div>
                                    <div>
                                        <strong>{% trans "Esperando aprobaci贸n" %}</strong>
                                        <p class="mb-0 text-muted-custom small">{% trans "La solicitud est谩 pendiente de revisi贸n" %}</p>
                                        <small class="text-muted-custom">{% now "d/m/Y H:i" %}</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="d-flex flex-column flex-md-row gap-3 pt-3 border-top border-custom">
                        <button class="btn btn-approve flex-fill" onclick="simulateApproval()">
                            <i class="bi bi-check-circle me-2"></i>
                            {% trans "Aprobar Solicitud" %}
                        </button>
                        <button class="btn btn-reject flex-fill" onclick="simulateRejection()">
                            <i class="bi bi-x-circle me-2"></i>
                            {% trans "Rechazar" %}
                        </button>
                        <button class="btn btn-outline-primary flex-fill" onclick="requestMoreInfo()">
                            <i class="bi bi-chat-dots me-2"></i>
                            {% trans "Solicitar Info" %}
                        </button>
                    </div>
                </div>
            </div>

            <!-- Demo Results -->
            <div id="demo-result" class="mt-4" style="display: none;">
                <!-- Results will be shown here -->
            </div>

            <!-- CTA Section -->
            <div class="text-center mt-5">
                <div class="card text-white border-0" style="background: linear-gradient(135deg, var(--primary-color), #8b5cf6);">
                    <div class="card-body p-5">
                        <h3 class="fw-bold mb-3">{% trans "驴Te gusta lo que ves?" %}</h3>
                        <p class="fs-5 mb-4 opacity-90">
                            {% trans "Comienza a gestionar tus aprobaciones de manera profesional" %}
                        </p>
                        <a href="{% url 'billing:select_plan' %}" class="btn btn-light btn-lg fw-bold" style="color: #4f46e5 !important;">
                            <i class="bi bi-rocket-takeoff me-2"></i>
                            {% trans "Suscribirme Ahora" %}
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
        // Demo Interactions
        function simulateApproval() {
            showResult('success', '{% trans "隆Solicitud Aprobada!" %}', '{% trans "La solicitud ha sido aprobada exitosamente. Se ha enviado notificaci贸n al solicitante y se proceder谩 con la compra." %}');
        }

        function simulateRejection() {
            showResult('danger', '{% trans "Solicitud Rechazada" %}', '{% trans "La solicitud ha sido rechazada. Se ha enviado notificaci贸n al solicitante con los motivos del rechazo." %}');
        }

        function requestMoreInfo() {
            showResult('info', '{% trans "Informaci贸n Solicitada" %}', '{% trans "Se ha enviado una solicitud de informaci贸n adicional al solicitante. La aprobaci贸n quedar谩 pendiente hasta recibir los datos necesarios." %}');
        }

        function showResult(type, title, message) {
            const resultDiv = document.getElementById('demo-result');
            const iconMap = {
                'success': 'bi-check-circle-fill',
                'danger': 'bi-x-circle-fill',
                'info': 'bi-info-circle-fill'
            };
            
            resultDiv.innerHTML = `
                <div class="alert alert-${type} d-flex align-items-center" role="alert">
                    <i class="${iconMap[type]} me-3 fs-4"></i>
                    <div>
                        <h5 class="alert-heading mb-1">${title}</h5>
                        <p class="mb-0">${message}</p>
                    </div>
                </div>
            `;
            
            resultDiv.style.display = 'block';
            resultDiv.scrollIntoView({ behavior: 'smooth' });
        }
</script>
{% endblock %}